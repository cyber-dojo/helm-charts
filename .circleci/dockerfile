# manually built and pushed as praqma/helm-gsutil
FROM docker:17

ENV HELM_VERSION=v2.14.1

# download apk index
RUN apk add --update

#common
RUN apk add --virtual .builtin-utils curl bash

#gsutil
RUN apk add --virtual .gsutil-runtime-deps python && \
    curl -Lo gsutil.tar.gz https://storage.googleapis.com/pub/gsutil.tar.gz && \
    tar -zxvf gsutil.tar.gz -C /usr/local/bin && \
    rm gsutil.tar.gz
ENV PATH=${PATH}:/usr/local/bin/gsutil 

# Install Helm
RUN curl -Lo helm-${HELM_VERSION}-linux-amd64.tar.gz https://get.helm.sh/helm-${HELM_VERSION}-linux-amd64.tar.gz && \
    tar -zxvf helm-${HELM_VERSION}-linux-amd64.tar.gz && \
    mv linux-amd64/helm /usr/local/bin/helm && \
    rm helm-${HELM_VERSION}-linux-amd64.tar.gz && \
    rm -rf linux-amd64

# cleanup
RUN rm -rf /var/cache/apk/*
